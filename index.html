<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2025 ç¾¤èŠç¤¾äº¤äººæ ¼æŠ¥å‘Š</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;700;900&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #0f172a;
            color: #ffffff;
            overflow: hidden;
        }

        /* åŠ¨æ€èƒŒæ™¯æµå…‰ */
        .ambient-light {
            position: absolute;
            width: 150vw;
            height: 150vw;
            background: radial-gradient(circle, rgba(99,102,241,0.15) 0%, rgba(15,23,42,0) 70%);
            top: -50%;
            left: -50%;
            animation: floatLight 15s infinite alternate ease-in-out;
            z-index: 0;
            pointer-events: none;
        }
        .ambient-light-2 {
            position: absolute;
            width: 120vw;
            height: 120vw;
            background: radial-gradient(circle, rgba(236, 72, 153, 0.1) 0%, rgba(15,23,42,0) 70%);
            bottom: -30%;
            right: -30%;
            animation: floatLight 20s infinite alternate-reverse ease-in-out;
            z-index: 0;
            pointer-events: none;
        }

        @keyframes floatLight {
            0% { transform: translate(0, 0) scale(1); }
            100% { transform: translate(10%, 10%) scale(1.1); }
        }

        /* Swiper å®¹å™¨ */
        .swiper {
            width: 100%;
            height: 100vh;
        }

        /* ç»ç’ƒæ‹Ÿæ€å¡ç‰‡ */
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        /* åŠ¨ç”»ç±» */
        .slide-in-up {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.22, 1, 0.36, 1);
        }

        .swiper-slide-active .slide-in-up {
            opacity: 1;
            transform: translateY(0);
        }

        /* å»¶è¿Ÿç±» */
        .delay-100 { transition-delay: 100ms; }
        .delay-200 { transition-delay: 200ms; }
        .delay-300 { transition-delay: 300ms; }
        .delay-400 { transition-delay: 400ms; }
        .delay-500 { transition-delay: 500ms; }

        /* å¤´åƒå…‰åœˆ */
        .avatar-glow {
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.5);
            animation: pulseGlow 3s infinite;
        }
        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 30px rgba(139, 92, 246, 0.5); }
            50% { box-shadow: 0 0 60px rgba(139, 92, 246, 0.8); }
        }

        /* éŸ³ä¹æ’­æ”¾å™¨æ—‹è½¬ */
        .spin-slow {
            animation: spin 8s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* è¯äº‘æ°”æ³¡åŠ¨ç”» */
        .word-bubble {
            animation: floatBubble 6s ease-in-out infinite;
        }
        @keyframes floatBubble {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* éšè—æ»šåŠ¨æ¡ */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* é»‘èƒ¶å”±ç‰‡çº¹ç† */
        .vinyl-record {
            background: conic-gradient(
                #1e1e1e 0%, #333 10%, #1e1e1e 20%, #333 30%,
                #1e1e1e 40%, #333 50%, #1e1e1e 60%, #333 70%,
                #1e1e1e 80%, #333 90%, #1e1e1e 100%
            );
            border-radius: 50%;
            position: relative;
        }
        .vinyl-record::before {
            content: '';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 30%; height: 30%;
            background: url('') center/cover no-repeat;
            border-radius: 50%;
            z-index: 2;
            border: 2px solid #000;
        }
    </style>
</head>
<body>

    <!-- èƒŒæ™¯å…‰æ•ˆ -->
    <div class="ambient-light"></div>
    <div class="ambient-light-2"></div>

    <!-- é¡¶éƒ¨éŸ³ä¹æ¡ (è£…é¥°) -->
    <div class="fixed top-0 left-0 w-full z-50 px-5 py-4 flex justify-between items-center bg-gradient-to-b from-slate-900/80 to-transparent">
        <div class="text-xs text-gray-400 tracking-widest">ASTRBOT REPORT 2025</div>
        <div class="flex space-x-1 items-end h-4">
            <div class="w-1 bg-green-400 animate-[bounce_1s_infinite] h-2"></div>
            <div class="w-1 bg-green-400 animate-[bounce_1.2s_infinite] h-4"></div>
            <div class="w-1 bg-green-400 animate-[bounce_0.8s_infinite] h-3"></div>
            <div class="w-1 bg-green-400 animate-[bounce_1.5s_infinite] h-1"></div>
        </div>
    </div>

    <!-- Swiper å®¹å™¨ -->
    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="slides-container">
            <!-- å¹»ç¯ç‰‡å°†é€šè¿‡ JS åŠ¨æ€ç”Ÿæˆ -->
        </div>
        <!-- åˆ†é¡µå™¨ -->
        <div class="swiper-pagination"></div>
    </div>

    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script>
        // ==========================
        // æ ¸å¿ƒæ•°æ® (ç›´æ¥åµŒå…¥ JSON)
        // ==========================
        const data = {
          "schema": "group_persona_report.v2",
          "generatedAt": 1766043232,
          "range": { "start": "2025-11-10", "end": "2025-12-10" },
          "target": {
            "groupId": "117906890",
            "userId": "845245653",
            "nickname": "å“ˆåŸºç±³",
            "avatar": { "url": "http://q.qlogo.cn/g?b=qq&nk=845245653&s=640" }
          },
          "stats": {
            "messageCount": 1260,
            "activeDays": 23,
            "time": { "worktimeRatio": 36, "nightOwlCount": 30 },
            "interaction": { "beMentionedCount": 325, "topicKillerRate": 5, "coolness": { "score": 38 } },
            "content": { "memeRatio": 10, "avgChars": 9 }
          },
          "rank": {
            "personaTitle": {
              "id": "night_philosopher",
              "name": "æ·±å¤œå“²å­¦å®¶",
              "reason": [
                "ä½ æœ‰30å¤©åœ¨æ·±å¤œæ´»è·ƒï¼Œæ˜¯ç¾¤èŠé‡Œæœ€ç†Ÿæ‚‰çš„å¤œçŒ«å­ã€‚",
                "ä½ çš„å‘è¨€å¹³å‡9ä¸ªå­—ï¼Œå´å¸¸å¸¸åœ¨æ·±å¤œå¼•å‘æ€è€ƒï¼Œæ¯”å¦‚å…³äºAIå‘å±•å’Œäººç”Ÿé‡å¼€ã€‚"
              ],
              "copywriting": "è¿™ä¸€å¹´ï¼Œä½ æ€»åœ¨å‡Œæ™¨å››ç‚¹æ€è€ƒäººç”Ÿï¼Œç•™ä¸‹1260æ¡æ¶ˆæ¯çš„ç—•è¿¹ã€‚\nå½“åˆ«äººæ²‰ç¡æ—¶ï¼Œä½ çš„æ€ç»ªåœ¨ç¾¤èŠé‡Œæ¸…é†’åœ°æ¸¸è¡ï¼Œä¸€å¥â€œæ„Ÿè§‰ç°åœ¨çš„äººç”Ÿé‡å¼€æœ‰ç‚¹è¿‡äºå°Šé‡å†å²äº†â€ï¼Œé“å‡ºäº†å¤šå°‘æ·±å¤œçš„å…±é¸£ä¸å­¤ç‹¬ã€‚"
            }
          },
          "social": {
            "mostYouCare": { "nickname": "ç»«", "score": 510 },
            "mostCareYou": { "nickname": "ç»«", "score": 318 },
            "bestCP": { "userB": { "nickname": "LaVI" }, "interactionScore": 35 },
            "lickDogTarget": { "nickname": "LaVI", "count": 502 },
            "topInteractions": [
                { "nickname": "ç»«", "score": 828 },
                { "nickname": "LaVI", "score": 808 },
                { "nickname": "å¤§æµ·å‚å­¦é•¿", "score": 580 }
            ]
          },
          "moments": {
            "latestNight": { "date": "2025-11-23", "time": "04:17", "text": "æ„Ÿè§‰ç°åœ¨çš„äººç”Ÿé‡å¼€æœ‰ç‚¹è¿‡äºå°Šé‡å†å²äº†" },
            "annualKeyword": "ç°åœ¨",
            "wordCloud": [
              { "word": "ç°åœ¨", "count": 31 }, { "word": "çŸ¥é“", "count": 29 }, { "word": "ç¾¤å‹", "count": 25 },
              { "word": "é‡å¼€", "count": 18 }, { "word": "å€™é¸Ÿ", "count": 16 }, { "word": "gemini", "count": 13 },
              { "word": "äººç”Ÿ", "count": 12 }, { "word": "å—æ¢", "count": 12 }, { "word": "é—®é¢˜", "count": 18 }
            ],
            "keywordRepresentations": [
              "æ„Ÿè§‰ç°åœ¨çš„äººç”Ÿé‡å¼€æœ‰ç‚¹è¿‡äºå°Šé‡å†å²äº†",
              "ç°åœ¨aiå‘å±•çš„æ¯”å¤§å¤šæ•°äººçš„å­¦ä¹ é€Ÿåº¦éƒ½å¿«",
              "ç°åœ¨å«æ‰°ä¹±å…¬å…±ç§©åº"
            ],
             "longestMessage": {
                "chars": 808,
                "text": "ä¸€ä¸ªå—æ¢åœ¨å¤–å·¥ä½œ20å¹´ç»ˆäºè¦å›å®¶äº†ï¼Œè€æ¿é—®ä»–ï¼šä½ æ˜¯è¦20å¹´çš„å·¥èµ„è¿˜æ˜¯è¦ä¸‰ä¸ªç”²åŸºå§ï¼Ÿå—æ¢è¯´ï¼šæˆ‘è€ƒè™‘ä¸€å¤©ï¼Œæ˜æ—©å†ç»™æ‚¨ç­”æ¡ˆå¥½å—ï¼Ÿè€æ¿è¯´å¯ä»¥ã€‚å—æ¢è€ƒè™‘äº†ä¸€æ•´æ™šï¼Œç¬¬äºŒå¤©ä»–å¯¹è€æ¿è¯´ï¼šæˆ‘è¦ä¸‰ä¸ªç”²åŸºå§ã€‚äºæ˜¯è€æ¿ç»™ä»–ä¸‰ä¸ªç”²åŸºå§ã€‚ç¬¬ä¸€ä¸ªæ¯”è¾ƒæ´»è·ƒï¼Œç¬¬äºŒä¸ªæ˜¯å·¨å‹é‡å‰‘ï¼Œç¬¬ä¸‰ä¸ªä¼šé‡Šæ”¾ç”µæµã€‚è¯´å®Œï¼Œè€æ¿åˆç»™å—æ¢ä¸€äº›è·¯è´¹å’Œä¸‰ä¸ªé¢åŒ…..."
             }
          },
          "ai": {
            "keywords": ["æ·±å¤œå“²å­¦å®¶", "è¯é¢˜ç»ˆç»“è€…", "æ°›å›´æ‹…å½“"],
            "sentiment": "emo",
            "oneLiner": "åœ¨åˆ«äººæ²‰ç¡çš„å¤œé‡Œï¼Œä½ ç‚¹äº®äº†æ€æƒ³çš„æ˜Ÿç«ã€‚",
            "tips": ["æ·±å¤œçµæ„Ÿè™½å¥½ï¼Œä¹Ÿåˆ«å¿˜äº†ç»™å¤§è„‘æ”¾ä¸ªå‡ã€‚", "ä½ ç»ˆç»“äº†61ä¸ªè¯é¢˜ï¼Œä¸‹æ¬¡è¯•è¯•ç”¨è¡¨æƒ…åŒ…æš–ä¸ªåœºï¼Ÿ"]
          }
        };

        // ==========================
        // æ¸²æŸ“é€»è¾‘
        // ==========================
        const container = document.getElementById('slides-container');

        // å·¥å…·ï¼šå¤„ç†é•¿æ–‡æœ¬æ¢è¡Œ
        const formatCopywriting = (text) => text.replace(/\n/g, '<br/>');

        // Slide 1: å°é¢
        const slide1 = `
            <div class="swiper-slide flex flex-col justify-center items-center px-8 relative">
                <div class="slide-in-up w-32 h-32 rounded-full overflow-hidden mb-8 border-4 border-white/20 avatar-glow relative">
                    <img src="${data.target.avatar.url}" onerror="this.src='https://api.dicebear.com/7.x/adventurer/svg?seed=Felix'" class="w-full h-full object-cover">
                </div>
                <h1 class="slide-in-up delay-100 text-3xl font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-300">
                    ${data.target.nickname}
                </h1>
                <p class="slide-in-up delay-200 text-gray-400 text-sm tracking-widest mb-12">2025 å¹´åº¦ç¤¾äº¤äººæ ¼æŠ¥å‘Š</p>
                <div class="slide-in-up delay-300 w-full glass-card p-6 text-center">
                    <p class="text-gray-300 text-sm mb-2">è¿™ä¸€å¹´ï¼Œä½ ä¸€å…±å‘å‡ºäº†</p>
                    <div class="text-5xl font-black text-white mb-2" id="msg-counter">0</div>
                    <p class="text-gray-300 text-sm">æ¡æ¶ˆæ¯</p>
                </div>
                <div class="absolute bottom-10 text-gray-600 text-xs animate-bounce">å‘ä¸Šæ»‘åŠ¨å¼€å¯å›å¿†</div>
            </div>
        `;

        // Slide 2: æ´»è·ƒåº¦ä¸ä¹ æƒ¯
        const slide2 = `
            <div class="swiper-slide flex flex-col justify-center px-6">
                <h2 class="slide-in-up text-4xl font-bold mb-8 text-white">æ—¶é—´çš„<br><span class="text-purple-400">ç¼éš™</span></h2>

                <div class="slide-in-up delay-100 glass-card p-6 mb-4 flex items-center justify-between">
                    <div>
                        <p class="text-gray-400 text-xs">æ´»è·ƒå¤©æ•°</p>
                        <p class="text-3xl font-bold">${data.stats.activeDays} <span class="text-sm font-normal text-gray-500">å¤©</span></p>
                    </div>
                    <div class="text-4xl">ğŸ“…</div>
                </div>

                <div class="slide-in-up delay-200 glass-card p-6 mb-4 bg-gradient-to-r from-indigo-900/50 to-purple-900/50 border-purple-500/30">
                    <div class="flex justify-between items-start mb-2">
                        <p class="text-purple-300 text-xs font-bold uppercase">Night Owl</p>
                        <i class="fa-solid fa-moon text-yellow-200 animate-pulse"></i>
                    </div>
                    <p class="text-lg text-gray-200 mb-1">ä½ æ˜¯ä¸€ä¸ªä¸æŠ˜ä¸æ‰£çš„å¤œçŒ«å­</p>
                    <p class="text-sm text-gray-400">å…±æœ‰ <span class="text-white font-bold text-xl">${data.stats.time.nightOwlCount}</span> ä¸ªå¤œæ™šï¼Œ<br>ä½ åœ¨å‡Œæ™¨ 1 ç‚¹åè¿˜åœ¨è¯´è¯ã€‚</p>
                </div>

                <div class="slide-in-up delay-300 flex space-x-4">
                    <div class="glass-card p-4 flex-1 text-center">
                        <p class="text-gray-400 text-xs mb-1">å«å›¾é‡</p>
                        <p class="text-xl font-bold">${data.stats.content.memeRatio}%</p>
                    </div>
                     <div class="glass-card p-4 flex-1 text-center">
                        <p class="text-gray-400 text-xs mb-1">å¹³å‡å­—æ•°</p>
                        <p class="text-xl font-bold">${data.stats.content.avgChars}</p>
                    </div>
                     <div class="glass-card p-4 flex-1 text-center">
                        <p class="text-gray-400 text-xs mb-1">é«˜å†·åº¦</p>
                        <p class="text-xl font-bold text-cyan-300">${data.stats.interaction.coolness.score}</p>
                    </div>
                </div>
            </div>
        `;

        // Slide 3: å¹´åº¦å…³é”®è¯ (è¯äº‘)
        const topWords = data.moments.wordCloud.slice(0, 5);
        const wordCloudHtml = topWords.map((w, i) => {
            const sizes = ['text-3xl', 'text-2xl', 'text-xl', 'text-lg', 'text-base'];
            const colors = ['text-pink-400', 'text-purple-300', 'text-blue-300', 'text-indigo-200', 'text-gray-400'];
            const positions = ['text-left pl-4', 'text-right pr-4', 'text-center', 'text-left pl-10', 'text-right pr-8'];
            return `<div class="${positions[i]} ${colors[i]} ${sizes[i]} font-bold mb-3 word-bubble" style="animation-delay: ${i*0.5}s">${w.word}</div>`;
        }).join('');

        const sentencesHtml = data.moments.keywordRepresentations.map(s =>
            `<div class="bg-white/5 rounded-lg p-3 text-xs text-gray-300 mb-2 border-l-2 border-pink-500 italic">"${s}"</div>`
        ).join('');

        const slide3 = `
            <div class="swiper-slide flex flex-col justify-center px-6">
                <div class="slide-in-up absolute top-20 right-4 opacity-20 text-9xl font-black text-white select-none pointer-events-none">
                    KEY<br>WORD
                </div>
                <p class="slide-in-up text-sm text-pink-400 tracking-widest mb-2">YOUR KEYWORD</p>
                <h2 class="slide-in-up delay-100 text-5xl font-black text-white mb-10">
                    ${data.moments.annualKeyword}
                </h2>

                <div class="slide-in-up delay-200 mb-8 relative h-40 flex flex-col justify-center">
                    ${wordCloudHtml}
                </div>

                <div class="slide-in-up delay-300 glass-card p-5">
                    <p class="text-xs text-gray-500 mb-3 uppercase">Memorable Contexts</p>
                    ${sentencesHtml}
                </div>
            </div>
        `;

        // Slide 4: æœ€æ™šå®‰æ—¶åˆ» (Emo æ—¶åˆ»)
        const slide4 = `
            <div class="swiper-slide flex flex-col justify-center items-center px-6 bg-gradient-to-b from-slate-900 via-blue-900 to-black">
                <div class="slide-in-up w-20 h-20 bg-white/10 rounded-full flex items-center justify-center mb-6 backdrop-blur-md">
                    <i class="fa-solid fa-moon text-3xl text-blue-200"></i>
                </div>

                <p class="slide-in-up delay-100 text-gray-400 text-sm mb-2">${data.moments.latestNight.date} å‡Œæ™¨</p>
                <h2 class="slide-in-up delay-200 text-6xl font-thin text-white mb-8 tracking-tighter">${data.moments.latestNight.time}</h2>

                <div class="slide-in-up delay-300 glass-card p-8 w-full relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-1 h-full bg-blue-500"></div>
                    <p class="text-lg text-blue-100 font-light leading-relaxed italic">
                        "${data.moments.latestNight.text}"
                    </p>
                    <p class="text-right text-xs text-gray-500 mt-4">â€” å½“å…¨ä¸–ç•Œéƒ½ç¡ç€çš„æ—¶å€™</p>
                </div>
                <p class="slide-in-up delay-400 text-xs text-gray-600 mt-12 text-center max-w-xs">
                    è¿™ä¸€åˆ»ï¼Œç¾¤èŠæ˜¯ä½ å”¯ä¸€çš„æ ‘æ´ã€‚
                </p>
            </div>
        `;

        // Slide 5: ç¤¾äº¤å…³ç³»
        const socialList = data.social.topInteractions.slice(0,3).map((u, i) => `
             <div class="flex items-center justify-between mb-3 pb-2 border-b border-white/5 last:border-0">
                <div class="flex items-center space-x-3">
                    <div class="text-xs font-bold text-gray-500 w-4">0${i+1}</div>
                    <div class="text-sm text-gray-200">${u.nickname}</div>
                </div>
                <div class="text-xs text-purple-300">${u.score} åˆ†</div>
            </div>
        `).join('');

        const slide5 = `
            <div class="swiper-slide flex flex-col justify-center px-6">
                <h2 class="slide-in-up text-3xl font-bold mb-6">ä½ çš„<br><span class="text-green-400">ç¾ç»Šç½‘ç»œ</span></h2>

                <div class="slide-in-up delay-100 grid grid-cols-2 gap-4 mb-6">
                    <div class="glass-card p-4 flex flex-col justify-between h-32 bg-pink-500/10 border-pink-500/20">
                        <i class="fa-solid fa-heart text-pink-400 mb-2"></i>
                        <div>
                            <p class="text-xs text-pink-300">Best CP</p>
                            <p class="text-lg font-bold text-white truncate">${data.social.bestCP.userB.nickname}</p>
                        </div>
                    </div>
                    <div class="glass-card p-4 flex flex-col justify-between h-32 bg-blue-500/10 border-blue-500/20">
                        <i class="fa-solid fa-paper-plane text-blue-400 mb-2"></i>
                        <div>
                            <p class="text-xs text-blue-300">å•å‘å¥”èµ´</p>
                            <p class="text-lg font-bold text-white truncate">${data.social.lickDogTarget.nickname}</p>
                        </div>
                    </div>
                </div>

                <div class="slide-in-up delay-200 glass-card p-6">
                    <p class="text-xs text-gray-400 mb-4 uppercase tracking-widest">Top Interactions</p>
                    ${socialList}
                </div>

                <div class="slide-in-up delay-300 mt-6 glass-card p-4 bg-gray-800/50">
                    <p class="text-xs text-gray-400 mb-1">æœ€é•¿çš„ä¸€æ¡æ¶ˆæ¯ (808å­—)</p>
                    <p class="text-xs text-gray-500 italic truncate">"${data.moments.longestMessage.text.substring(0, 30)}..."</p>
                </div>
            </div>
        `;

        // Slide 6: å¹´åº¦äººè®¾ (Rank)
        const slide6 = `
            <div class="swiper-slide flex flex-col justify-center items-center px-6 text-center relative overflow-hidden">
                <!-- æ—‹è½¬èƒŒæ™¯ -->
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[150vw] h-[150vw] bg-gradient-to-tr from-purple-900/30 via-transparent to-transparent rounded-full spin-slow z-[-1]"></div>

                <p class="slide-in-up text-sm text-purple-400 tracking-[0.3em] mb-4">ANNUAL PERSONA</p>

                <div class="slide-in-up delay-100 mb-8 relative">
                    <div class="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-br from-white via-purple-200 to-gray-500 drop-shadow-lg">
                        ${data.rank.personaTitle.name}
                    </div>
                    <!-- è£…é¥°çº¿ -->
                    <div class="w-20 h-1 bg-purple-500 mx-auto mt-4 rounded-full"></div>
                </div>

                <div class="slide-in-up delay-200 glass-card p-8 bg-black/20 backdrop-blur-xl border-t border-white/10">
                    <p class="text-sm leading-7 text-gray-200 text-justify">
                        ${formatCopywriting(data.rank.personaTitle.copywriting)}
                    </p>
                </div>

                <div class="slide-in-up delay-300 mt-8 flex flex-wrap justify-center gap-2">
                    ${data.ai.keywords.map(k => `<span class="px-3 py-1 rounded-full border border-gray-600 text-xs text-gray-400">${k}</span>`).join('')}
                </div>
            </div>
        `;

        // Slide 7: æ€»ç»“ (AI Tips)
        const slide7 = `
            <div class="swiper-slide flex flex-col justify-center px-6 bg-slate-900">
                 <div class="slide-in-up mb-10">
                    <i class="fa-solid fa-quote-left text-4xl text-gray-700 mb-4"></i>
                    <h2 class="text-2xl font-bold text-white leading-relaxed">
                        ${data.ai.oneLiner}
                    </h2>
                 </div>

                 <div class="slide-in-up delay-100 glass-card p-6 mb-4 border-l-4 border-yellow-500">
                    <p class="text-yellow-500 font-bold text-xs mb-2 uppercase">AI Tips</p>
                    <p class="text-sm text-gray-300 mb-2">ğŸ’¡ ${data.ai.tips[0]}</p>
                    <p class="text-sm text-gray-300">ğŸ’¡ ${data.ai.tips[1]}</p>
                 </div>

                 <div class="slide-in-up delay-300 mt-12 text-center">
                    <div class="w-16 h-16 bg-gradient-to-br from-green-400 to-blue-500 rounded-lg mx-auto mb-4 flex items-center justify-center shadow-lg shadow-green-500/20">
                        <i class="fa-solid fa-share-nodes text-2xl text-white"></i>
                    </div>
                    <button class="bg-white text-black px-8 py-3 rounded-full font-bold text-sm shadow-lg active:scale-95 transition-transform" onclick="shareReport()">
                        åˆ†äº«æˆ‘çš„å¹´åº¦æŠ¥å‘Š
                    </button>
                    <p class="text-gray-600 text-xs mt-4">Generated by AstrBot Plugin</p>
                 </div>
            </div>
        `;

        // æ³¨å…¥ Slides
        container.innerHTML = slide1 + slide2 + slide3 + slide4 + slide5 + slide6 + slide7;

        // ==========================
        // åˆå§‹åŒ– Swiper
        // ==========================
        const swiper = new Swiper(".mySwiper", {
            direction: "vertical",
            effect: "fade", // ä½¿ç”¨æ·¡å…¥æ·¡å‡ºæ•ˆæœæ›´æœ‰é«˜çº§æ„Ÿ
            fadeEffect: { crossFade: true },
            pagination: {
                el: ".swiper-pagination",
                clickable: true,
            },
            mousewheel: true,
            on: {
                init: function () {
                    animateNumbers();
                },
                slideChangeTransitionStart: function () {
                    // é‡ç½®åŠ¨ç”»ï¼šç§»é™¤ active class
                    const activeSlide = this.slides[this.activeIndex];
                    const prevSlide = this.slides[this.previousIndex];

                    // ç®€å•çš„é‡ç»˜æŠ€å·§è§¦å‘ CSS åŠ¨ç”»
                    // æ³¨æ„ï¼šSwiper çš„ effect: fade å¯èƒ½ä¼šè®© slide å§‹ç»ˆå­˜åœ¨ DOM ä¸­
                    // è¿™é‡Œæˆ‘ä»¬ä¾èµ– CSS çš„ .swiper-slide-active é€‰æ‹©å™¨æ¥è§¦å‘åŠ¨ç”»
                }
            }
        });

        // æ•°å­—å¢é•¿åŠ¨ç”»
        function animateNumbers() {
            const el = document.getElementById('msg-counter');
            const target = data.stats.messageCount;
            let current = 0;
            const duration = 1500;
            const step = target / (duration / 16);

            function update() {
                current += step;
                if (current < target) {
                    el.innerText = Math.floor(current);
                    requestAnimationFrame(update);
                } else {
                    el.innerText = target;
                }
            }
            update();
        }

        // ==========================
        // åˆ†äº«åŠŸèƒ½
        // ==========================
        async function shareReport() {
            const shareData = {
                title: 'æˆ‘çš„2025ç¾¤èŠç¤¾äº¤äººæ ¼å‘¨æŠ¥',
                text: `æˆ‘çš„å¹´åº¦å…³é”®è¯æ˜¯ï¼š${data.moments.annualKeyword}ï¼Œäººè®¾æ˜¯ã€${data.rank.personaTitle.name}ã€‘ï¼å¿«æ¥çœ‹çœ‹ä½ çš„å§ã€‚`,
                url: window.location.href // æ³¨æ„ï¼šå¦‚æœæ˜¯æœ¬åœ°æ–‡ä»¶(file://)ï¼Œåˆ†äº«çš„URLåˆ«äººæ— æ³•æ‰“å¼€ï¼Œéœ€è¦éƒ¨ç½²
            };

            // ä¼˜å…ˆå°è¯• Web Share API (ç§»åŠ¨ç«¯å‹å¥½)
            if (navigator.share) {
                try {
                    await navigator.share(shareData);
                } catch (err) {
                    console.log('åˆ†äº«å–æ¶ˆæˆ–å¤±è´¥:', err);
                }
            } else {
                // å›é€€æ–¹æ¡ˆï¼šæç¤ºéƒ¨ç½²æˆ–æˆªå›¾
                if (window.location.protocol === 'file:') {
                     alert('æˆªå›¾åˆ†äº«ç»™ç¾¤å‹å§ï¼(æç¤ºï¼šæœ¬åœ°æ–‡ä»¶æ— æ³•ç›´æ¥åˆ†äº«é“¾æ¥ï¼Œè¯·å°† HTML éƒ¨ç½²åˆ° Netlify/Github Pages)');
                } else {
                     // ç®€å•å¤åˆ¶é“¾æ¥
                     navigator.clipboard.writeText(`${shareData.text} ${shareData.url}`).then(() => {
                        alert('é“¾æ¥å’Œæ–‡æ¡ˆå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼å¿«å»ç²˜è´´åˆ†äº«å§ã€‚');
                     }).catch(() => {
                        alert('æˆªå›¾åˆ†äº«ç»™ç¾¤å‹å§ï¼');
                     });
                }
            }
        }

    </script>
</body>
</html>
